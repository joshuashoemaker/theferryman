<!DOCTYPE html>

<html>

    <head>
        <title>The Ferry Man</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <!-- normalize -->
        <link rel="stylesheet" href="css/libs/normalize/normalize.css"/>
        <!-- bootstrap -->
        <link rel="stylesheet" href="css/libs/bootstrap/css/bootstrap.min.css"/>
        <!-- bootstrap theme -->
        <link rel="stylesheet" href="css/libs/bootstrap/css/bootstrap-theme.min.css"/>
        <!-- custom theme -->
        <link rel="stylesheet" href="css/style.css"/>
        <script src="js/mapStyles.js"></script>
        <script src="js/locations.js"></script>

    </head>

    <body>
        <header class="top-bar">
            
            <h3 data-bind="click: toggleMenu" class="menu-icon glyphicon glyphicon-th-list"></h3>
            <h3 class="app-title">The Ferry Man <small>A Guide to Dante's Florence</small></h3>

        </header>

        <section class="list-menu" data-bind="css: { 'off-left': !visible() }">
            <input type="text" class="search form-control">

            <ul class="list-group place-list" data-bind="foreach: locations">
                <li data-bind="text: name, click: $parent.selectLocation" class="list-group-item place-item"></li>
            </ul>
        </section>

        

        <div id="map"></div>

        <section data-bind="with: selectedLocation" class="info-window">
            <div class="selected-info">
                <h4 class="selected-name" data-bind="text: name"></h4>
                <p class="selected-description" data-bind="text: description"></p>
            </div>
        </section>

        

        <script src="js/libs/knockout.js"></script>
        
        <script>
            let map = {}
            let markers = []
            function initMap() {

                var initPost = {lat: locationList[0].coord[0], lng: locationList[0].coord[1]};
                map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 15,
                    center: initPost,
                    styles: mapStyles,
                    disableDefaultUI: true,
                    
                    selectMapLocation: function(locationName){
                        markers.forEach(function(marker) {
                            if(marker.title === locationName){
                                marker.setAnimation(google.maps.Animation.BOUNCE);
                            }
                            if(marker.title != locationName){
                                marker.setAnimation(google.maps.Animation.NONE);
                            }
                        }, this);
                    }
            });
            locationList.forEach(function(loc) {
                let marker = new google.maps.Marker({
                    position: {lat: loc.coord[0], lng: loc.coord[1]},
                    animation: google.maps.Animation.DROP,
                    title: loc.name,
                    map: map
                });
            markers.push(marker);
        }, this);
        
          }
        </script>
        <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGWJSOzXs72lece0D4vyKrFfYPUuOnnEs&callback=initMap">
        </script>

    
        <script src="js/app.js"></script>
    </body>

</html>